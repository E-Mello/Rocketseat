{"version":3,"file":"tether.esm.js","sources":["../../src/js/utils/type-check.js","../../src/js/utils/classes.js","../../src/js/utils/deferred.js","../../src/js/utils/general.js","../../src/js/utils/bounds.js","../../src/js/abutment.js","../../src/js/constraint.js","../../src/js/shift.js","../../src/js/evented.js","../../src/js/utils/offset.js","../../src/js/utils/parents.js","../../src/js/tether.js"],"sourcesContent":["/**\n * Checks if `value` is classified as a `Function` object.\n * @param {*} value The param to check if it is a function\n */\nexport function isFunction(value) {\n  return typeof value === 'function';\n}\n\n/**\n * Checks if `value` is classified as a `Number` object.\n * @param {*} value The param to check if it is a number\n */\nexport function isNumber(value) {\n  return typeof value === 'number';\n}\n\n/**\n * Checks if `value` is classified as an `Object`.\n * @param {*} value The param to check if it is an object\n */\nexport function isObject(value) {\n  return typeof value === 'object';\n}\n\n/**\n * Checks if `value` is classified as a `String` object.\n * @param {*} value The param to check if it is a string\n */\nexport function isString(value) {\n  return typeof value === 'string';\n}\n\n/**\n * Checks if `value` is undefined.\n * @param {*} value The param to check if it is undefined\n */\nexport function isUndefined(value) {\n  return value === undefined;\n}\n","import { isUndefined } from './type-check';\n\nexport function addClass(el, name) {\n  name.split(' ').forEach((cls) => {\n    if (cls.trim()) {\n      el.classList.add(cls);\n    }\n  });\n}\n\n/**\n * Get class string based on previously determined classes\n * @param  {String} [key=''] - default value for the classes object\n * @param  {Object} classes\n * @param  {String} classPrefix\n */\nexport function getClass(key = '', classes, classPrefix) {\n  if (!isUndefined(classes) && !isUndefined(classes[key])) {\n    if (classes[key] === false) {\n      return '';\n    }\n    return classes[key];\n  } else if (classPrefix) {\n    return `${classPrefix}-${key}`;\n  } else {\n    return key;\n  }\n}\n\nexport function removeClass(el, name) {\n  name.split(' ').forEach((cls) => {\n    if (cls.trim()) {\n      el.classList.remove(cls);\n    }\n  });\n}\n\nexport function updateClasses(el, add, all) {\n  // Of the set of 'all' classes, we need the 'add' classes, and only the\n  // 'add' classes to be set.\n  all.forEach((cls) => {\n    if (add.indexOf(cls) === -1 && el.classList.contains(cls)) {\n      removeClass(el, cls);\n    }\n  });\n\n  add.forEach((cls) => {\n    if (!el.classList.contains(cls)) {\n      addClass(el, cls);\n    }\n  });\n}\n","const deferred = [];\n\nexport function defer(fn) {\n  deferred.push(fn);\n}\n\nexport function flush() {\n  let fn;\n  // eslint-disable-next-line\n  while (fn = deferred.pop()) {\n    fn();\n  }\n}\n","let _scrollBarSize = null;\n\nexport function extend(out = {}) {\n  const args = [];\n\n  Array.prototype.push.apply(args, arguments);\n\n  args.slice(1).forEach((obj) => {\n    if (obj) {\n      for (let key in obj) {\n        if ({}.hasOwnProperty.call(obj, key)) {\n          out[key] = obj[key];\n        }\n      }\n    }\n  });\n\n  return out;\n}\n\nexport function getScrollBarSize() {\n  if (_scrollBarSize) {\n    return _scrollBarSize;\n  }\n  const inner = document.createElement('div');\n  inner.style.width = '100%';\n  inner.style.height = '200px';\n\n  const outer = document.createElement('div');\n  extend(outer.style, {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    pointerEvents: 'none',\n    visibility: 'hidden',\n    width: '200px',\n    height: '150px',\n    overflow: 'hidden'\n  });\n\n  outer.appendChild(inner);\n\n  document.body.appendChild(outer);\n\n  const widthContained = inner.offsetWidth;\n  outer.style.overflow = 'scroll';\n  let widthScroll = inner.offsetWidth;\n\n  if (widthContained === widthScroll) {\n    widthScroll = outer.clientWidth;\n  }\n\n  document.body.removeChild(outer);\n\n  const width = widthContained - widthScroll;\n\n  _scrollBarSize = { width, height: width };\n  return _scrollBarSize;\n}\n\nexport const uniqueId = (() => {\n  let id = 0;\n  return () => ++id;\n})();\n","import { defer } from './deferred';\nimport { extend, uniqueId } from './general';\nimport { isUndefined } from './type-check';\n\nconst zeroPosCache = {};\nlet zeroElement = null;\n\nexport function getBounds(body, el) {\n  let doc;\n  if (el === document) {\n    doc = document;\n    el = document.documentElement;\n  } else {\n    doc = el.ownerDocument;\n  }\n\n  const docEl = doc.documentElement;\n\n  const box = _getActualBoundingClientRect(el);\n\n  const origin = _getOrigin(body);\n\n  box.top -= origin.top;\n  box.left -= origin.left;\n\n  if (isUndefined(box.width)) {\n    box.width = document.body.scrollWidth - box.left - box.right;\n  }\n  if (isUndefined(box.height)) {\n    box.height = document.body.scrollHeight - box.top - box.bottom;\n  }\n\n  box.top = box.top - docEl.clientTop;\n  box.left = box.left - docEl.clientLeft;\n  box.right = doc.body.clientWidth - box.width - box.left;\n  box.bottom = doc.body.clientHeight - box.height - box.top;\n\n  return box;\n}\n\n/**\n * Gets bounds for when target modifiier is 'scroll-handle'\n * @param target\n * @return {{left: number, width: number, height: number}}\n */\nexport function getScrollHandleBounds(body, target) {\n  let bounds;\n  // We have to do the check for the scrollTop and if target === document.body here and set to variables\n  // because we may reset target below.\n  const targetScrollTop = target.scrollTop;\n  const targetIsBody = target === document.body;\n\n  if (targetIsBody) {\n    target = document.documentElement;\n\n    bounds = {\n      left: pageXOffset,\n      top: pageYOffset,\n      height: innerHeight,\n      width: innerWidth\n    };\n  } else {\n    bounds = getBounds(body, target);\n  }\n\n  const style = getComputedStyle(target);\n\n  const hasBottomScroll = (\n    target.scrollWidth > target.clientWidth ||\n    [style.overflow, style.overflowX].indexOf('scroll') >= 0 ||\n    !targetIsBody\n  );\n\n  let scrollBottom = 0;\n  if (hasBottomScroll) {\n    scrollBottom = 15;\n  }\n\n  const height = bounds.height - parseFloat(style.borderTopWidth) - parseFloat(style.borderBottomWidth) - scrollBottom;\n\n  const out = {\n    width: 15,\n    height: height * 0.975 * (height / target.scrollHeight),\n    left: bounds.left + bounds.width - parseFloat(style.borderLeftWidth) - 15\n  };\n\n  let fitAdj = 0;\n  if (height < 408 && targetIsBody) {\n    fitAdj = -0.00011 * Math.pow(height, 2) - 0.00727 * height + 22.58;\n  }\n\n  if (!targetIsBody) {\n    out.height = Math.max(out.height, 24);\n  }\n\n  const scrollPercentage = targetScrollTop / (target.scrollHeight - height);\n  out.top = scrollPercentage * (height - out.height - fitAdj) + bounds.top + parseFloat(style.borderTopWidth);\n\n  if (targetIsBody) {\n    out.height = Math.max(out.height, 24);\n  }\n\n  return out;\n}\n\n/**\n * Gets bounds for when target modifiier is 'visible\n * @param target\n * @return {{top: *, left: *, width: *, height: *}}\n */\nexport function getVisibleBounds(body, target) {\n  if (target === document.body) {\n    return { top: pageYOffset, left: pageXOffset, height: innerHeight, width: innerWidth };\n  } else {\n    const bounds = getBounds(body, target);\n\n    const out = {\n      height: bounds.height,\n      width: bounds.width,\n      top: bounds.top,\n      left: bounds.left\n    };\n\n    out.height = Math.min(out.height, bounds.height - (pageYOffset - bounds.top));\n    out.height = Math.min(out.height, bounds.height - ((bounds.top + bounds.height) - (pageYOffset + innerHeight)));\n    out.height = Math.min(innerHeight, out.height);\n    out.height -= 2;\n\n    out.width = Math.min(out.width, bounds.width - (pageXOffset - bounds.left));\n    out.width = Math.min(out.width, bounds.width - ((bounds.left + bounds.width) - (pageXOffset + innerWidth)));\n    out.width = Math.min(innerWidth, out.width);\n    out.width -= 2;\n\n    if (out.top < pageYOffset) {\n      out.top = pageYOffset;\n    }\n    if (out.left < pageXOffset) {\n      out.left = pageXOffset;\n    }\n\n    return out;\n  }\n}\n\nexport function removeUtilElements(body) {\n  if (zeroElement) {\n    body.removeChild(zeroElement);\n  }\n  zeroElement = null;\n}\n\n/**\n * Same as native getBoundingClientRect, except it takes into account parent <frame> offsets\n * if the element lies within a nested document (<frame> or <iframe>-like).\n * @param node\n */\nfunction _getActualBoundingClientRect(node) {\n  let boundingRect = node.getBoundingClientRect();\n\n  // The original object returned by getBoundingClientRect is immutable, so we clone it\n  // We can't use extend because the properties are not considered part of the object by hasOwnProperty in IE9\n  let rect = {};\n  for (let k in boundingRect) {\n    rect[k] = boundingRect[k];\n  }\n\n  try {\n    if (node.ownerDocument !== document) {\n      let { frameElement } = node.ownerDocument.defaultView;\n      if (frameElement) {\n        let frameRect = _getActualBoundingClientRect(frameElement);\n        rect.top += frameRect.top;\n        rect.bottom += frameRect.top;\n        rect.left += frameRect.left;\n        rect.right += frameRect.left;\n      }\n    }\n  } catch (err) {\n    // Ignore \"Access is denied\" in IE11/Edge\n  }\n\n  return rect;\n}\n\nfunction _getOrigin(body) {\n  // getBoundingClientRect is unfortunately too accurate.  It introduces a pixel or two of\n  // jitter as the user scrolls that messes with our ability to detect if two positions\n  // are equivilant or not.  We place an element at the top left of the page that will\n  // get the same jitter, so we can cancel the two out.\n  let node = zeroElement;\n  if (!node || !body.contains(node)) {\n    node = document.createElement('div');\n    node.setAttribute('data-tether-id', uniqueId());\n    extend(node.style, {\n      top: 0,\n      left: 0,\n      position: 'absolute'\n    });\n\n    body.appendChild(node);\n\n    zeroElement = node;\n  }\n\n  const id = node.getAttribute('data-tether-id');\n  if (isUndefined(zeroPosCache[id])) {\n    zeroPosCache[id] = _getActualBoundingClientRect(node);\n\n    // Clear the cache when this position call is done\n    defer(() => {\n      delete zeroPosCache[id];\n    });\n  }\n\n  return zeroPosCache[id];\n}\n","import { getClass, updateClasses } from './utils/classes';\nimport { defer } from './utils/deferred';\nimport { getBounds } from './utils/bounds';\n\nexport default {\n  position({ top, left }) {\n    const { height, width } = this.cache('element-bounds', () => {\n      return getBounds(this.element);\n    });\n\n    const targetPos = this.getTargetBounds();\n\n    const bottom = top + height;\n    const right = left + width;\n\n    const abutted = [];\n    if (top <= targetPos.bottom && bottom >= targetPos.top) {\n      ['left', 'right'].forEach((side) => {\n        const targetPosSide = targetPos[side];\n        if (targetPosSide === left || targetPosSide === right) {\n          abutted.push(side);\n        }\n      });\n    }\n\n    if (left <= targetPos.right && right >= targetPos.left) {\n      ['top', 'bottom'].forEach((side) => {\n        const targetPosSide = targetPos[side];\n        if (targetPosSide === top || targetPosSide === bottom) {\n          abutted.push(side);\n        }\n      });\n    }\n\n    const sides = ['left', 'top', 'right', 'bottom'];\n    const { classes, classPrefix } = this.options;\n    this.all.push(getClass('abutted', classes, classPrefix));\n    sides.forEach((side) => {\n      this.all.push(`${getClass('abutted', classes, classPrefix)}-${side}`);\n    });\n\n    if (abutted.length) {\n      this.add.push(getClass('abutted', classes, classPrefix));\n    }\n\n    abutted.forEach((side) => {\n      this.add.push(`${getClass('abutted', classes, classPrefix)}-${side}`);\n    });\n\n    defer(() => {\n      if (!(this.options.addTargetClasses === false)) {\n        updateClasses(this.target, this.add, this.all);\n      }\n      updateClasses(this.element, this.add, this.all);\n    });\n\n    return true;\n  }\n};\n","import { getClass, updateClasses } from './utils/classes';\nimport { defer } from './utils/deferred';\nimport { extend } from './utils/general';\nimport { getBounds } from './utils/bounds';\nimport { isString, isUndefined } from './utils/type-check';\n\nconst BOUNDS_FORMAT = ['left', 'top', 'right', 'bottom'];\n\n/**\n * Returns an array of bounds of the format [left, top, right, bottom]\n * @param tether\n * @param to\n * @return {*[]|HTMLElement|ActiveX.IXMLDOMElement}\n */\nfunction getBoundingRect(body, tether, to) {\n  // arg to is required\n  if (!to) {\n    return null;\n  }\n  if (to === 'scrollParent') {\n    to = tether.scrollParents[0];\n  } else if (to === 'window') {\n    to = [pageXOffset, pageYOffset, innerWidth + pageXOffset, innerHeight + pageYOffset];\n  }\n\n  if (to === document) {\n    to = to.documentElement;\n  }\n\n  if (!isUndefined(to.nodeType)) {\n    const node = to;\n    const size = getBounds(body, to);\n    const pos = size;\n    const style = getComputedStyle(to);\n\n    to = [pos.left, pos.top, size.width + pos.left, size.height + pos.top];\n\n    // Account any parent Frames scroll offset\n    if (node.ownerDocument !== document) {\n      let win = node.ownerDocument.defaultView;\n      to[0] += win.pageXOffset;\n      to[1] += win.pageYOffset;\n      to[2] += win.pageXOffset;\n      to[3] += win.pageYOffset;\n    }\n\n    BOUNDS_FORMAT.forEach((side, i) => {\n      side = side[0].toUpperCase() + side.substr(1);\n      if (side === 'Top' || side === 'Left') {\n        to[i] += parseFloat(style[`border${side}Width`]);\n      } else {\n        to[i] -= parseFloat(style[`border${side}Width`]);\n      }\n    });\n  }\n\n  return to;\n}\n\n/**\n * Add out of bounds classes to the list of classes we add to tether\n * @param {string[]} oob An array of directions that are out of bounds\n * @param {string[]} addClasses The array of classes to add to Tether\n * @param {string[]} classes The array of class types for Tether\n * @param {string} classPrefix The prefix to add to the front of the class\n * @param {string} outOfBoundsClass The class to apply when out of bounds\n * @private\n */\nfunction _addOutOfBoundsClass(oob, addClasses, classes, classPrefix, outOfBoundsClass) {\n  if (oob.length) {\n    let oobClass;\n    if (!isUndefined(outOfBoundsClass)) {\n      oobClass = outOfBoundsClass;\n    } else {\n      oobClass = getClass('out-of-bounds', classes, classPrefix);\n    }\n\n    addClasses.push(oobClass);\n    oob.forEach((side) => {\n      addClasses.push(`${oobClass}-${side}`);\n    });\n  }\n}\n\n/**\n * Calculates if out of bounds or pinned in the X direction.\n *\n * @param {number} left\n * @param {number[]} bounds Array of bounds of the format [left, top, right, bottom]\n * @param {number} width\n * @param pin\n * @param pinned\n * @param {string[]} oob\n * @return {number}\n * @private\n */\nfunction _calculateOOBAndPinnedLeft(left, bounds, width, pin, pinned, oob) {\n  if (left < bounds[0]) {\n    if (pin.indexOf('left') >= 0) {\n      left = bounds[0];\n      pinned.push('left');\n    } else {\n      oob.push('left');\n    }\n  }\n\n  if (left + width > bounds[2]) {\n    if (pin.indexOf('right') >= 0) {\n      left = bounds[2] - width;\n      pinned.push('right');\n    } else {\n      oob.push('right');\n    }\n  }\n\n  return left;\n}\n\n/**\n * Calculates if out of bounds or pinned in the Y direction.\n *\n * @param {number} top\n * @param {number[]} bounds Array of bounds of the format [left, top, right, bottom]\n * @param {number} height\n * @param pin\n * @param {string[]} pinned\n * @param {string[]} oob\n * @return {number}\n * @private\n */\nfunction _calculateOOBAndPinnedTop(top, bounds, height, pin, pinned, oob) {\n  if (top < bounds[1]) {\n    if (pin.indexOf('top') >= 0) {\n      top = bounds[1];\n      pinned.push('top');\n    } else {\n      oob.push('top');\n    }\n  }\n\n  if (top + height > bounds[3]) {\n    if (pin.indexOf('bottom') >= 0) {\n      top = bounds[3] - height;\n      pinned.push('bottom');\n    } else {\n      oob.push('bottom');\n    }\n  }\n\n  return top;\n}\n\n/**\n * Flip X \"together\"\n * @param {object} tAttachment The target attachment\n * @param {object} eAttachment The element attachment\n * @param {number[]} bounds Array of bounds of the format [left, top, right, bottom]\n * @param {number} width\n * @param targetWidth\n * @param {number} left\n * @private\n */\nfunction _flipXTogether(tAttachment, eAttachment, bounds, width, targetWidth, left) {\n  if (left < bounds[0] && tAttachment.left === 'left') {\n    if (eAttachment.left === 'right') {\n      left += targetWidth;\n      tAttachment.left = 'right';\n\n      left += width;\n      eAttachment.left = 'left';\n\n    } else if (eAttachment.left === 'left') {\n      left += targetWidth;\n      tAttachment.left = 'right';\n\n      left -= width;\n      eAttachment.left = 'right';\n    }\n\n  } else if (left + width > bounds[2] && tAttachment.left === 'right') {\n    if (eAttachment.left === 'left') {\n      left -= targetWidth;\n      tAttachment.left = 'left';\n\n      left -= width;\n      eAttachment.left = 'right';\n\n    } else if (eAttachment.left === 'right') {\n      left -= targetWidth;\n      tAttachment.left = 'left';\n\n      left += width;\n      eAttachment.left = 'left';\n    }\n\n  } else if (tAttachment.left === 'center') {\n    if (left + width > bounds[2] && eAttachment.left === 'left') {\n      left -= width;\n      eAttachment.left = 'right';\n\n    } else if (left < bounds[0] && eAttachment.left === 'right') {\n      left += width;\n      eAttachment.left = 'left';\n    }\n  }\n\n  return left;\n}\n\n/**\n * Flip Y \"together\"\n * @param {object} tAttachment The target attachment\n * @param {object} eAttachment The element attachment\n * @param {number[]} bounds Array of bounds of the format [left, top, right, bottom]\n * @param {number} height\n * @param targetHeight\n * @param {number} top\n * @private\n */\nfunction _flipYTogether(tAttachment, eAttachment, bounds, height, targetHeight, top) {\n  if (tAttachment.top === 'top') {\n    if (eAttachment.top === 'bottom' && top < bounds[1]) {\n      top += targetHeight;\n      tAttachment.top = 'bottom';\n\n      top += height;\n      eAttachment.top = 'top';\n\n    } else if (eAttachment.top === 'top' && top + height > bounds[3] && top - (height - targetHeight) >= bounds[1]) {\n      top -= height - targetHeight;\n      tAttachment.top = 'bottom';\n\n      eAttachment.top = 'bottom';\n    }\n  }\n\n  if (tAttachment.top === 'bottom') {\n    if (eAttachment.top === 'top' && top + height > bounds[3]) {\n      top -= targetHeight;\n      tAttachment.top = 'top';\n\n      top -= height;\n      eAttachment.top = 'bottom';\n\n    } else if (eAttachment.top === 'bottom' && top < bounds[1] && top + (height * 2 - targetHeight) <= bounds[3]) {\n      top += height - targetHeight;\n      tAttachment.top = 'top';\n\n      eAttachment.top = 'top';\n\n    }\n  }\n\n  if (tAttachment.top === 'middle') {\n    if (top + height > bounds[3] && eAttachment.top === 'top') {\n      top -= height;\n      eAttachment.top = 'bottom';\n\n    } else if (top < bounds[1] && eAttachment.top === 'bottom') {\n      top += height;\n      eAttachment.top = 'top';\n    }\n  }\n\n  return top;\n}\n\n/**\n * Get all the initial classes\n * @param classes\n * @param {string} classPrefix\n * @param constraints\n * @return {[*, *]}\n * @private\n */\nfunction _getAllClasses(classes, classPrefix, constraints) {\n  const allClasses = [getClass('pinned', classes, classPrefix), getClass('out-of-bounds', classes, classPrefix)];\n\n  constraints.forEach((constraint) => {\n    const { outOfBoundsClass, pinnedClass } = constraint;\n    if (outOfBoundsClass) {\n      allClasses.push(outOfBoundsClass);\n    }\n    if (pinnedClass) {\n      allClasses.push(pinnedClass);\n    }\n  });\n\n  allClasses.forEach((cls) => {\n    ['left', 'top', 'right', 'bottom'].forEach((side) => {\n      allClasses.push(`${cls}-${side}`);\n    });\n  });\n\n  return allClasses;\n}\n\nexport default {\n  position({ top, left, targetAttachment }) {\n    if (!this.options.constraints) {\n      return true;\n    }\n\n    let { height, width } = this.cache('element-bounds', () => {\n      return getBounds(this.bodyElement, this.element);\n    });\n\n    if (width === 0 && height === 0 && !isUndefined(this.lastSize)) {\n      // Handle the item getting hidden as a result of our positioning without glitching\n      // the classes in and out\n      ({ width, height } = this.lastSize);\n    }\n\n    const targetSize = this.cache('target-bounds', () => {\n      return this.getTargetBounds();\n    });\n\n    const { height: targetHeight, width: targetWidth } = targetSize;\n    const { classes, classPrefix } = this.options;\n\n    const allClasses = _getAllClasses(classes, classPrefix, this.options.constraints);\n    const addClasses = [];\n\n    const tAttachment = extend({}, targetAttachment);\n    const eAttachment = extend({}, this.attachment);\n\n    this.options.constraints.forEach((constraint) => {\n      let { to, attachment, pin } = constraint;\n\n      if (isUndefined(attachment)) {\n        attachment = '';\n      }\n\n      let changeAttachX, changeAttachY;\n      if (attachment.indexOf(' ') >= 0) {\n        [changeAttachY, changeAttachX] = attachment.split(' ');\n      } else {\n        changeAttachX = changeAttachY = attachment;\n      }\n\n      const bounds = getBoundingRect(this.bodyElement, this, to);\n\n      if (changeAttachY === 'target' || changeAttachY === 'both') {\n        if (top < bounds[1] && tAttachment.top === 'top') {\n          top += targetHeight;\n          tAttachment.top = 'bottom';\n        }\n\n        if (top + height > bounds[3] && tAttachment.top === 'bottom') {\n          top -= targetHeight;\n          tAttachment.top = 'top';\n        }\n      }\n\n      if (changeAttachY === 'together') {\n        top = _flipYTogether(tAttachment, eAttachment, bounds, height, targetHeight, top);\n      }\n\n      if (changeAttachX === 'target' || changeAttachX === 'both') {\n        if (left < bounds[0] && tAttachment.left === 'left') {\n          left += targetWidth;\n          tAttachment.left = 'right';\n        }\n\n        if (left + width > bounds[2] && tAttachment.left === 'right') {\n          left -= targetWidth;\n          tAttachment.left = 'left';\n        }\n      }\n\n      if (changeAttachX === 'together') {\n        left = _flipXTogether(tAttachment, eAttachment, bounds, width, targetWidth, left);\n      }\n\n      if (changeAttachY === 'element' || changeAttachY === 'both') {\n        if (top < bounds[1] && eAttachment.top === 'bottom') {\n          top += height;\n          eAttachment.top = 'top';\n        }\n\n        if (top + height > bounds[3] && eAttachment.top === 'top') {\n          top -= height;\n          eAttachment.top = 'bottom';\n        }\n      }\n\n      if (changeAttachX === 'element' || changeAttachX === 'both') {\n        if (left < bounds[0]) {\n          if (eAttachment.left === 'right') {\n            left += width;\n            eAttachment.left = 'left';\n          } else if (eAttachment.left === 'center') {\n            left += (width / 2);\n            eAttachment.left = 'left';\n          }\n        }\n\n        if (left + width > bounds[2]) {\n          if (eAttachment.left === 'left') {\n            left -= width;\n            eAttachment.left = 'right';\n          } else if (eAttachment.left === 'center') {\n            left -= (width / 2);\n            eAttachment.left = 'right';\n          }\n        }\n      }\n\n      if (isString(pin)) {\n        pin = pin.split(',').map((p) => p.trim());\n      } else if (pin === true) {\n        pin = ['top', 'left', 'right', 'bottom'];\n      }\n\n      pin = pin || [];\n\n      const pinned = [];\n      const oob = [];\n\n      left = _calculateOOBAndPinnedLeft(left, bounds, width, pin, pinned, oob);\n      top = _calculateOOBAndPinnedTop(top, bounds, height, pin, pinned, oob);\n\n      if (pinned.length) {\n        let pinnedClass;\n        if (!isUndefined(this.options.pinnedClass)) {\n          pinnedClass = this.options.pinnedClass;\n        } else {\n          pinnedClass = getClass('pinned', classes, classPrefix);\n        }\n\n        addClasses.push(pinnedClass);\n        pinned.forEach((side) => {\n          addClasses.push(`${pinnedClass}-${side}`);\n        });\n      }\n\n      _addOutOfBoundsClass(oob, addClasses, classes, classPrefix, this.options.outOfBoundsClass);\n\n      if (pinned.indexOf('left') >= 0 || pinned.indexOf('right') >= 0) {\n        eAttachment.left = tAttachment.left = false;\n      }\n      if (pinned.indexOf('top') >= 0 || pinned.indexOf('bottom') >= 0) {\n        eAttachment.top = tAttachment.top = false;\n      }\n\n      if (tAttachment.top !== targetAttachment.top ||\n        tAttachment.left !== targetAttachment.left ||\n        eAttachment.top !== this.attachment.top ||\n        eAttachment.left !== this.attachment.left) {\n        this.updateAttachClasses(eAttachment, tAttachment);\n        this.trigger('update', {\n          attachment: eAttachment,\n          targetAttachment: tAttachment\n        });\n      }\n    });\n\n    defer(() => {\n      if (!(this.options.addTargetClasses === false)) {\n        updateClasses(this.target, addClasses, allClasses);\n      }\n      updateClasses(this.element, addClasses, allClasses);\n    });\n\n    return { top, left };\n  }\n};\n","import { isFunction, isString } from './utils/type-check';\n\nexport default {\n  position({ top, left }) {\n    if (!this.options.shift) {\n      return;\n    }\n\n    let { shift } = this.options;\n    if (isFunction(shift)) {\n      shift = shift.call(this, { top, left });\n    }\n\n    let shiftTop, shiftLeft;\n    if (isString(shift)) {\n      shift = shift.split(' ');\n      shift[1] = shift[1] || shift[0];\n\n      ([shiftTop, shiftLeft] = shift);\n\n      shiftTop = parseFloat(shiftTop, 10);\n      shiftLeft = parseFloat(shiftLeft, 10);\n    } else {\n      ([shiftTop, shiftLeft] = [shift.top, shift.left]);\n    }\n\n    top += shiftTop;\n    left += shiftLeft;\n\n    return { top, left };\n  }\n};\n","import { isUndefined } from './utils/type-check';\n\nexport class Evented {\n  on(event, handler, ctx, once = false) {\n    if (isUndefined(this.bindings)) {\n      this.bindings = {};\n    }\n    if (isUndefined(this.bindings[event])) {\n      this.bindings[event] = [];\n    }\n    this.bindings[event].push({ handler, ctx, once });\n\n    return this;\n  }\n\n  once(event, handler, ctx) {\n    return this.on(event, handler, ctx, true);\n  }\n\n  off(event, handler) {\n    if (isUndefined(this.bindings) ||\n      isUndefined(this.bindings[event])) {\n      return this;\n    }\n\n    if (isUndefined(handler)) {\n      delete this.bindings[event];\n    } else {\n      this.bindings[event].forEach((binding, index) => {\n        if (binding.handler === handler) {\n          this.bindings[event].splice(index, 1);\n        }\n      });\n    }\n\n    return this;\n  }\n\n  trigger(event, ...args) {\n    if (!isUndefined(this.bindings) && this.bindings[event]) {\n      this.bindings[event].forEach((binding, index) => {\n        const { ctx, handler, once } = binding;\n\n        const context = ctx || this;\n\n        handler.apply(context, args);\n\n        if (once) {\n          this.bindings[event].splice(index, 1);\n        }\n      });\n    }\n\n    return this;\n  }\n}\n","import { isString, isUndefined } from './type-check';\n\nconst MIRROR_LR = {\n  center: 'center',\n  left: 'right',\n  right: 'left'\n};\n\nconst MIRROR_TB = {\n  middle: 'middle',\n  top: 'bottom',\n  bottom: 'top'\n};\n\nconst OFFSET_MAP = {\n  top: 0,\n  left: 0,\n  middle: '50%',\n  center: '50%',\n  bottom: '100%',\n  right: '100%'\n};\n\nexport function addOffset(...offsets) {\n  const out = { top: 0, left: 0 };\n\n  offsets.forEach(({ top, left }) => {\n    if (isString(top)) {\n      top = parseFloat(top);\n    }\n    if (isString(left)) {\n      left = parseFloat(left);\n    }\n\n    out.top += top;\n    out.left += left;\n  });\n\n  return out;\n}\n\nexport function attachmentToOffset(attachment) {\n  let { left, top } = attachment;\n\n  if (!isUndefined(OFFSET_MAP[attachment.left])) {\n    left = OFFSET_MAP[attachment.left];\n  }\n\n  if (!isUndefined(OFFSET_MAP[attachment.top])) {\n    top = OFFSET_MAP[attachment.top];\n  }\n\n  return { left, top };\n}\n\nexport function autoToFixedAttachment(attachment, relativeToAttachment) {\n  let { left, top } = attachment;\n\n  if (left === 'auto') {\n    left = MIRROR_LR[relativeToAttachment.left];\n  }\n\n  if (top === 'auto') {\n    top = MIRROR_TB[relativeToAttachment.top];\n  }\n\n  return { left, top };\n}\n\nexport function offsetToPx(offset, size) {\n  if (isString(offset.left) && offset.left.indexOf('%') !== -1) {\n    offset.left = parseFloat(offset.left) / 100 * size.width;\n  }\n  if (isString(offset.top) && offset.top.indexOf('%') !== -1) {\n    offset.top = parseFloat(offset.top) / 100 * size.height;\n  }\n\n  return offset;\n}\n\nexport function parseTopLeft(value) {\n  const [top, left] = value.split(' ');\n  return { top, left };\n}\n","import { isUndefined } from './type-check';\n\nexport function getScrollParents(el) {\n  // In firefox if the el is inside an iframe with display: none; window.getComputedStyle() will return null;\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=548397\n  const computedStyle = getComputedStyle(el) || {};\n  const { position } = computedStyle;\n  let parents = [];\n\n  if (position === 'fixed') {\n    return [el];\n  }\n\n  let parent = el;\n  while ((parent = parent.parentNode) && parent && parent.nodeType === 1) {\n    let style;\n    try {\n      style = getComputedStyle(parent);\n    } catch (err) {\n      // Intentionally blank\n    }\n\n    if (isUndefined(style) || style === null) {\n      parents.push(parent);\n      return parents;\n    }\n\n    const { overflow, overflowX, overflowY } = style;\n    if (/(auto|scroll|overlay)/.test(overflow + overflowY + overflowX)) {\n      if (position !== 'absolute' || ['relative', 'absolute', 'fixed'].indexOf(style.position) >= 0) {\n        parents.push(parent);\n      }\n    }\n  }\n\n  parents.push(el.ownerDocument.body);\n\n  // If the node is within a frame, account for the parent window scroll\n  if (el.ownerDocument !== document) {\n    parents.push(el.ownerDocument.defaultView);\n  }\n\n  return parents;\n}\n\nexport function getOffsetParent(el) {\n  return el.offsetParent || document.documentElement;\n}\n","import '../css/tether.scss';\nimport '../css/tether-theme-arrows.scss';\nimport '../css/tether-theme-arrows-dark.scss';\nimport '../css/tether-theme-basic.scss';\nimport Abutment from './abutment';\nimport Constraint from './constraint';\nimport Shift from './shift';\nimport { Evented } from './evented';\nimport {\n  addClass,\n  getClass,\n  removeClass,\n  updateClasses\n} from './utils/classes';\nimport { defer, flush } from './utils/deferred';\nimport { extend, getScrollBarSize } from './utils/general';\nimport {\n  addOffset,\n  attachmentToOffset,\n  autoToFixedAttachment,\n  offsetToPx,\n  parseTopLeft\n} from './utils/offset';\nimport {\n  getBounds,\n  getScrollHandleBounds,\n  getVisibleBounds,\n  removeUtilElements\n} from './utils/bounds';\nimport { getOffsetParent, getScrollParents } from './utils/parents';\nimport { isNumber, isObject, isString, isUndefined } from './utils/type-check';\n\nconst TetherBase = { modules: [Constraint, Abutment, Shift] };\n\nfunction isFullscreenElement(e) {\n  let d = e.ownerDocument;\n  let fe =\n    d.fullscreenElement ||\n    d.webkitFullscreenElement ||\n    d.mozFullScreenElement ||\n    d.msFullscreenElement;\n  return fe === e;\n}\n\nfunction within(a, b, diff = 1) {\n  return a + diff >= b && b >= a - diff;\n}\n\nconst transformKey = (() => {\n  if (isUndefined(document)) {\n    return '';\n  }\n  const el = document.createElement('div');\n\n  const transforms = [\n    'transform',\n    'WebkitTransform',\n    'OTransform',\n    'MozTransform',\n    'msTransform'\n  ];\n  for (let i = 0; i < transforms.length; ++i) {\n    const key = transforms[i];\n    if (el.style[key] !== undefined) {\n      return key;\n    }\n  }\n})();\n\nconst tethers = [];\n\nconst position = () => {\n  tethers.forEach((tether) => {\n    tether.position(false);\n  });\n  flush();\n};\n\nfunction now() {\n  return performance.now();\n}\n\n(() => {\n  let lastCall = null;\n  let lastDuration = null;\n  let pendingTimeout = null;\n\n  const tick = () => {\n    if (!isUndefined(lastDuration) && lastDuration > 16) {\n      // We voluntarily throttle ourselves if we can't manage 60fps\n      lastDuration = Math.min(lastDuration - 16, 250);\n\n      // Just in case this is the last event, remember to position just once more\n      pendingTimeout = setTimeout(tick, 250);\n      return;\n    }\n\n    if (!isUndefined(lastCall) && now() - lastCall < 10) {\n      // Some browsers call events a little too frequently, refuse to run more than is reasonable\n      return;\n    }\n\n    if (pendingTimeout != null) {\n      clearTimeout(pendingTimeout);\n      pendingTimeout = null;\n    }\n\n    lastCall = now();\n    position();\n    lastDuration = now() - lastCall;\n  };\n\n  if (!isUndefined(window) && !isUndefined(window.addEventListener)) {\n    ['resize', 'scroll', 'touchmove'].forEach((event) => {\n      window.addEventListener(event, tick);\n    });\n  }\n})();\n\nclass TetherClass extends Evented {\n  constructor(options) {\n    super();\n    this.position = this.position.bind(this);\n\n    tethers.push(this);\n\n    this.history = [];\n\n    this.setOptions(options, false);\n\n    TetherBase.modules.forEach((module) => {\n      if (!isUndefined(module.initialize)) {\n        module.initialize.call(this);\n      }\n    });\n\n    this.position();\n  }\n\n  setOptions(options, pos = true) {\n    const defaults = {\n      offset: '0 0',\n      targetOffset: '0 0',\n      targetAttachment: 'auto auto',\n      classPrefix: 'tether',\n      bodyElement: document.body\n    };\n\n    this.options = extend(defaults, options);\n\n    let { element, target, targetModifier, bodyElement } = this.options;\n    this.element = element;\n    this.target = target;\n    this.targetModifier = targetModifier;\n\n    if (typeof bodyElement === 'string') {\n      bodyElement = document.querySelector(bodyElement);\n    }\n    this.bodyElement = bodyElement;\n\n    if (this.target === 'viewport') {\n      this.target = document.body;\n      this.targetModifier = 'visible';\n    } else if (this.target === 'scroll-handle') {\n      this.target = document.body;\n      this.targetModifier = 'scroll-handle';\n    }\n\n    ['element', 'target'].forEach((key) => {\n      if (isUndefined(this[key])) {\n        throw new Error(\n          'Tether Error: Both element and target must be defined'\n        );\n      }\n\n      if (!isUndefined(this[key].jquery)) {\n        this[key] = this[key][0];\n      } else if (isString(this[key])) {\n        this[key] = document.querySelector(this[key]);\n      }\n    });\n\n    this._addClasses();\n\n    if (!this.options.attachment) {\n      throw new Error('Tether Error: You must provide an attachment');\n    }\n\n    this.targetAttachment = parseTopLeft(this.options.targetAttachment);\n    this.attachment = parseTopLeft(this.options.attachment);\n    this.offset = parseTopLeft(this.options.offset);\n    this.targetOffset = parseTopLeft(this.options.targetOffset);\n\n    if (!isUndefined(this.scrollParents)) {\n      this.disable();\n    }\n\n    if (this.targetModifier === 'scroll-handle') {\n      this.scrollParents = [this.target];\n    } else {\n      this.scrollParents = getScrollParents(this.target);\n    }\n\n    if (!(this.options.enabled === false)) {\n      this.enable(pos);\n    }\n  }\n\n  getTargetBounds() {\n    if (!isUndefined(this.targetModifier)) {\n      if (this.targetModifier === 'visible') {\n        return getVisibleBounds(this.bodyElement, this.target);\n      } else if (this.targetModifier === 'scroll-handle') {\n        return getScrollHandleBounds(this.bodyElement, this.target);\n      }\n    } else {\n      return getBounds(this.bodyElement, this.target);\n    }\n  }\n\n  clearCache() {\n    this._cache = {};\n  }\n\n  cache(k, getter) {\n    // More than one module will often need the same DOM info, so\n    // we keep a cache which is cleared on each position call\n    if (isUndefined(this._cache)) {\n      this._cache = {};\n    }\n\n    if (isUndefined(this._cache[k])) {\n      this._cache[k] = getter.call(this);\n    }\n\n    return this._cache[k];\n  }\n\n  enable(pos = true) {\n    const { classes, classPrefix } = this.options;\n    if (!(this.options.addTargetClasses === false)) {\n      addClass(this.target, getClass('enabled', classes, classPrefix));\n    }\n    addClass(this.element, getClass('enabled', classes, classPrefix));\n    this.enabled = true;\n\n    this.scrollParents.forEach((parent) => {\n      if (parent !== this.target.ownerDocument) {\n        parent.addEventListener('scroll', this.position);\n      }\n    });\n\n    if (pos) {\n      this.position();\n    }\n  }\n\n  disable() {\n    const { classes, classPrefix } = this.options;\n    removeClass(this.target, getClass('enabled', classes, classPrefix));\n    removeClass(this.element, getClass('enabled', classes, classPrefix));\n    this.enabled = false;\n\n    if (!isUndefined(this.scrollParents)) {\n      this.scrollParents.forEach((parent) => {\n        if (parent && parent.removeEventListener) {\n          parent.removeEventListener('scroll', this.position);\n        }\n      });\n    }\n  }\n\n  destroy() {\n    this.disable();\n\n    this._removeClasses();\n\n    tethers.forEach((tether, i) => {\n      if (tether === this) {\n        tethers.splice(i, 1);\n      }\n    });\n\n    // Remove any elements we were using for convenience from the DOM\n    if (tethers.length === 0) {\n      removeUtilElements(this.bodyElement);\n    }\n  }\n\n  updateAttachClasses(elementAttach, targetAttach) {\n    elementAttach = elementAttach || this.attachment;\n    targetAttach = targetAttach || this.targetAttachment;\n    const sides = ['left', 'top', 'bottom', 'right', 'middle', 'center'];\n    const { classes, classPrefix } = this.options;\n\n    if (!isUndefined(this._addAttachClasses) && this._addAttachClasses.length) {\n      // updateAttachClasses can be called more than once in a position call, so\n      // we need to clean up after ourselves such that when the last defer gets\n      // ran it doesn't add any extra classes from previous calls.\n      this._addAttachClasses.splice(0, this._addAttachClasses.length);\n    }\n\n    if (isUndefined(this._addAttachClasses)) {\n      this._addAttachClasses = [];\n    }\n    this.add = this._addAttachClasses;\n\n    if (elementAttach.top) {\n      this.add.push(\n        `${getClass('element-attached', classes, classPrefix)}-${\n          elementAttach.top\n        }`\n      );\n    }\n    if (elementAttach.left) {\n      this.add.push(\n        `${getClass('element-attached', classes, classPrefix)}-${\n          elementAttach.left\n        }`\n      );\n    }\n    if (targetAttach.top) {\n      this.add.push(\n        `${getClass('target-attached', classes, classPrefix)}-${\n          targetAttach.top\n        }`\n      );\n    }\n    if (targetAttach.left) {\n      this.add.push(\n        `${getClass('target-attached', classes, classPrefix)}-${\n          targetAttach.left\n        }`\n      );\n    }\n\n    this.all = [];\n    sides.forEach((side) => {\n      this.all.push(\n        `${getClass('element-attached', classes, classPrefix)}-${side}`\n      );\n      this.all.push(\n        `${getClass('target-attached', classes, classPrefix)}-${side}`\n      );\n    });\n\n    defer(() => {\n      if (isUndefined(this._addAttachClasses)) {\n        return;\n      }\n\n      updateClasses(this.element, this._addAttachClasses, this.all);\n      if (!(this.options.addTargetClasses === false)) {\n        updateClasses(this.target, this._addAttachClasses, this.all);\n      }\n\n      delete this._addAttachClasses;\n    });\n  }\n\n  position(flushChanges = true) {\n    // flushChanges commits the changes immediately, leave true unless you are positioning multiple\n    // tethers (in which case call Tether.Utils.flush yourself when you're done)\n\n    if (!this.enabled) {\n      return;\n    }\n\n    this.clearCache();\n\n    // Turn 'auto' attachments into the appropriate corner or edge\n    const targetAttachment = autoToFixedAttachment(\n      this.targetAttachment,\n      this.attachment\n    );\n\n    this.updateAttachClasses(this.attachment, targetAttachment);\n\n    const elementPos = this.cache('element-bounds', () => {\n      return getBounds(this.bodyElement, this.element);\n    });\n\n    let { width, height } = elementPos;\n\n    if (width === 0 && height === 0 && !isUndefined(this.lastSize)) {\n      // We cache the height and width to make it possible to position elements that are\n      // getting hidden.\n      ({ width, height } = this.lastSize);\n    } else {\n      this.lastSize = { width, height };\n    }\n\n    const targetPos = this.cache('target-bounds', () => {\n      return this.getTargetBounds();\n    });\n    const targetSize = targetPos;\n\n    // Get an actual px offset from the attachment\n    let offset = offsetToPx(attachmentToOffset(this.attachment), {\n      width,\n      height\n    });\n    let targetOffset = offsetToPx(\n      attachmentToOffset(targetAttachment),\n      targetSize\n    );\n\n    const manualOffset = offsetToPx(this.offset, { width, height });\n    const manualTargetOffset = offsetToPx(this.targetOffset, targetSize);\n\n    // Add the manually provided offset\n    offset = addOffset(offset, manualOffset);\n    targetOffset = addOffset(targetOffset, manualTargetOffset);\n\n    // It's now our goal to make (element position + offset) == (target position + target offset)\n    let left = targetPos.left + targetOffset.left - offset.left;\n    let top = targetPos.top + targetOffset.top - offset.top;\n\n    for (let i = 0; i < TetherBase.modules.length; ++i) {\n      const module = TetherBase.modules[i];\n      const ret = module.position.call(this, {\n        left,\n        top,\n        targetAttachment,\n        targetPos,\n        elementPos,\n        offset,\n        targetOffset,\n        manualOffset,\n        manualTargetOffset,\n        scrollbarSize,\n        attachment: this.attachment\n      });\n\n      if (ret === false) {\n        return false;\n      } else if (isUndefined(ret) || !isObject(ret)) {\n        continue;\n      } else {\n        ({ top, left } = ret);\n      }\n    }\n\n    // We describe the position three different ways to give the optimizer\n    // a chance to decide the best possible way to position the element\n    // with the fewest repaints.\n    const next = {\n      // It's position relative to the page (absolute positioning when\n      // the element is a child of the body)\n      page: {\n        top,\n        left\n      },\n\n      // It's position relative to the viewport (fixed positioning)\n      viewport: {\n        top: top - pageYOffset,\n        bottom: pageYOffset - top - height + innerHeight,\n        left: left - pageXOffset,\n        right: pageXOffset - left - width + innerWidth\n      }\n    };\n\n    let doc = this.target.ownerDocument;\n    let win = doc.defaultView;\n\n    let scrollbarSize;\n    if (win.innerHeight > doc.documentElement.clientHeight) {\n      scrollbarSize = this.cache('scrollbar-size', getScrollBarSize);\n      next.viewport.bottom -= scrollbarSize.height;\n    }\n\n    if (win.innerWidth > doc.documentElement.clientWidth) {\n      scrollbarSize = this.cache('scrollbar-size', getScrollBarSize);\n      next.viewport.right -= scrollbarSize.width;\n    }\n\n    if (\n      ['', 'static'].indexOf(doc.body.style.position) === -1 ||\n      ['', 'static'].indexOf(doc.body.parentElement.style.position) === -1\n    ) {\n      // Absolute positioning in the body will be relative to the page, not the 'initial containing block'\n      next.page.bottom = doc.body.scrollHeight - top - height;\n      next.page.right = doc.body.scrollWidth - left - width;\n    }\n\n    if (\n      !isUndefined(this.options.optimizations) &&\n      this.options.optimizations.moveElement !== false &&\n      isUndefined(this.targetModifier)\n    ) {\n      const offsetParent = this.cache('target-offsetparent', () =>\n        getOffsetParent(this.target)\n      );\n      const offsetPosition = this.cache('target-offsetparent-bounds', () =>\n        getBounds(this.bodyElement, offsetParent)\n      );\n      const offsetParentStyle = getComputedStyle(offsetParent);\n      const offsetParentSize = offsetPosition;\n\n      const offsetBorder = {};\n      ['Top', 'Left', 'Bottom', 'Right'].forEach((side) => {\n        offsetBorder[side.toLowerCase()] = parseFloat(\n          offsetParentStyle[`border${side}Width`]\n        );\n      });\n\n      offsetPosition.right =\n        doc.body.scrollWidth -\n        offsetPosition.left -\n        offsetParentSize.width +\n        offsetBorder.right;\n      offsetPosition.bottom =\n        doc.body.scrollHeight -\n        offsetPosition.top -\n        offsetParentSize.height +\n        offsetBorder.bottom;\n\n      if (\n        next.page.top >= offsetPosition.top + offsetBorder.top &&\n        next.page.bottom >= offsetPosition.bottom\n      ) {\n        if (\n          next.page.left >= offsetPosition.left + offsetBorder.left &&\n          next.page.right >= offsetPosition.right\n        ) {\n          // We're within the visible part of the target's scroll parent\n          const { scrollLeft, scrollTop } = offsetParent;\n\n          // It's position relative to the target's offset parent (absolute positioning when\n          // the element is moved to be a child of the target's offset parent).\n          next.offset = {\n            top:\n              next.page.top - offsetPosition.top + scrollTop - offsetBorder.top,\n            left:\n              next.page.left -\n              offsetPosition.left +\n              scrollLeft -\n              offsetBorder.left\n          };\n        }\n      }\n    }\n\n    // We could also travel up the DOM and try each containing context, rather than only\n    // looking at the body, but we're gonna get diminishing returns.\n\n    this.move(next);\n\n    this.history.unshift(next);\n\n    if (this.history.length > 3) {\n      this.history.pop();\n    }\n\n    if (flushChanges) {\n      flush();\n    }\n\n    return true;\n  }\n\n  // THE ISSUE\n  move(pos) {\n    if (isUndefined(this.element.parentNode)) {\n      return;\n    }\n\n    const same = {};\n\n    for (let type in pos) {\n      same[type] = {};\n\n      for (let key in pos[type]) {\n        let found = false;\n\n        for (let i = 0; i < this.history.length; ++i) {\n          const point = this.history[i];\n          if (\n            !isUndefined(point[type]) &&\n            !within(point[type][key], pos[type][key])\n          ) {\n            found = true;\n            break;\n          }\n        }\n\n        if (!found) {\n          same[type][key] = true;\n        }\n      }\n    }\n\n    let css = { top: '', left: '', right: '', bottom: '' };\n\n    const transcribe = (_same, _pos) => {\n      const hasOptimizations = !isUndefined(this.options.optimizations);\n      const gpu = hasOptimizations ? this.options.optimizations.gpu : null;\n      if (gpu !== false) {\n        let yPos, xPos;\n        if (_same.top) {\n          css.top = 0;\n          yPos = _pos.top;\n        } else {\n          css.bottom = 0;\n          yPos = -_pos.bottom;\n        }\n\n        if (_same.left) {\n          css.left = 0;\n          xPos = _pos.left;\n        } else {\n          css.right = 0;\n          xPos = -_pos.right;\n        }\n\n        if (isNumber(window.devicePixelRatio) && devicePixelRatio % 1 === 0) {\n          xPos = Math.round(xPos * devicePixelRatio) / devicePixelRatio;\n          yPos = Math.round(yPos * devicePixelRatio) / devicePixelRatio;\n        }\n\n        css[transformKey] = `translateX(${xPos}px) translateY(${yPos}px)`;\n\n        if (transformKey !== 'msTransform') {\n          // The Z transform will keep this in the GPU (faster, and prevents artifacts),\n          // but IE9 doesn't support 3d transforms and will choke.\n          css[transformKey] += ' translateZ(0)';\n        }\n      } else {\n        if (_same.top) {\n          css.top = `${_pos.top}px`;\n        } else {\n          css.bottom = `${_pos.bottom}px`;\n        }\n\n        if (_same.left) {\n          css.left = `${_pos.left}px`;\n        } else {\n          css.right = `${_pos.right}px`;\n        }\n      }\n    };\n\n    const hasOptimizations = !isUndefined(this.options.optimizations);\n    let allowPositionFixed = true;\n\n    if (\n      hasOptimizations &&\n      this.options.optimizations.allowPositionFixed === false\n    ) {\n      allowPositionFixed = false;\n    }\n\n    let moved = false;\n    if (\n      (same.page.top || same.page.bottom) &&\n      (same.page.left || same.page.right)\n    ) {\n      css.position = 'absolute';\n      transcribe(same.page, pos.page);\n    } else if (\n      allowPositionFixed &&\n      (same.viewport.top || same.viewport.bottom) &&\n      (same.viewport.left || same.viewport.right)\n    ) {\n      css.position = 'fixed';\n      transcribe(same.viewport, pos.viewport);\n    } else if (\n      !isUndefined(same.offset) &&\n      same.offset.top &&\n      same.offset.left\n    ) {\n      css.position = 'absolute';\n      const offsetParent = this.cache('target-offsetparent', () =>\n        getOffsetParent(this.target)\n      );\n\n      if (getOffsetParent(this.element) !== offsetParent) {\n        defer(() => {\n          this.element.parentNode.removeChild(this.element);\n          offsetParent.appendChild(this.element);\n        });\n      }\n\n      transcribe(same.offset, pos.offset);\n      moved = true;\n    } else {\n      css.position = 'absolute';\n      transcribe({ top: true, left: true }, pos.page);\n    }\n\n    if (!moved) {\n      if (this.options.bodyElement) {\n        if (this.element.parentNode !== this.options.bodyElement) {\n          this.options.bodyElement.appendChild(this.element);\n        }\n      } else {\n        let offsetParentIsBody = true;\n\n        let currentNode = this.element.parentNode;\n        while (\n          currentNode &&\n          currentNode.nodeType === 1 &&\n          currentNode.tagName !== 'BODY' &&\n          !isFullscreenElement(currentNode)\n        ) {\n          if (getComputedStyle(currentNode).position !== 'static') {\n            offsetParentIsBody = false;\n            break;\n          }\n\n          currentNode = currentNode.parentNode;\n        }\n\n        if (!offsetParentIsBody) {\n          this.element.parentNode.removeChild(this.element);\n          this.element.ownerDocument.body.appendChild(this.element);\n        }\n      }\n    }\n\n    // Any css change will trigger a repaint, so let's avoid one if nothing changed\n    const writeCSS = {};\n    let write = false;\n    for (let key in css) {\n      let val = css[key];\n      let elVal = this.element.style[key];\n\n      if (elVal !== val) {\n        write = true;\n        writeCSS[key] = val;\n      }\n    }\n\n    if (write) {\n      defer(() => {\n        extend(this.element.style, writeCSS);\n        this.trigger('repositioned');\n      });\n    }\n  }\n\n  _addClasses() {\n    const { classes, classPrefix } = this.options;\n    addClass(this.element, getClass('element', classes, classPrefix));\n    if (!(this.options.addTargetClasses === false)) {\n      addClass(this.target, getClass('target', classes, classPrefix));\n    }\n  }\n\n  _removeClasses() {\n    const { classes, classPrefix } = this.options;\n    removeClass(this.element, getClass('element', classes, classPrefix));\n    if (!(this.options.addTargetClasses === false)) {\n      removeClass(this.target, getClass('target', classes, classPrefix));\n    }\n\n    this.all.forEach((className) => {\n      this.element.classList.remove(className);\n      this.target.classList.remove(className);\n    });\n  }\n}\n\nTetherClass.modules = [];\n\nTetherBase.position = position;\n\nlet Tether = extend(TetherClass, TetherBase);\n\nTether.modules.push({\n  initialize() {\n    const { classes, classPrefix } = this.options;\n    this.markers = {};\n\n    ['target', 'element'].forEach((type) => {\n      const el = document.createElement('div');\n      el.className = getClass(`${type}-marker`, classes, classPrefix);\n\n      const dot = document.createElement('div');\n      dot.className = getClass('marker-dot', classes, classPrefix);\n      el.appendChild(dot);\n\n      this[type].appendChild(el);\n\n      this.markers[type] = { dot, el };\n    });\n  },\n\n  position({ manualOffset, manualTargetOffset }) {\n    const offsets = {\n      element: manualOffset,\n      target: manualTargetOffset\n    };\n\n    for (let type in offsets) {\n      const offset = offsets[type];\n      for (let side in offset) {\n        let val = offset[side];\n        if (\n          !isString(val) ||\n          (val.indexOf('%') === -1 && val.indexOf('px') === -1)\n        ) {\n          val += 'px';\n        }\n\n        if (this.markers[type] && this.markers[type].dot?.style[side] !== val) {\n          this.markers[type].dot.style[side] = val;\n        }\n      }\n    }\n\n    return true;\n  }\n});\n\nexport default Tether;\n"],"names":["isFunction","value","isNumber","isObject","isString","isUndefined","undefined","addClass","el","name","split","forEach","cls","trim","classList","add","getClass","key","classes","classPrefix","removeClass","remove","updateClasses","all","indexOf","contains","deferred","defer","fn","push","flush","pop","_scrollBarSize","extend","out","args","Array","prototype","apply","arguments","slice","obj","hasOwnProperty","call","getScrollBarSize","inner","document","createElement","style","width","height","outer","position","top","left","pointerEvents","visibility","overflow","appendChild","body","widthContained","offsetWidth","widthScroll","clientWidth","removeChild","uniqueId","id","zeroPosCache","zeroElement","getBounds","doc","documentElement","ownerDocument","docEl","box","_getActualBoundingClientRect","origin","_getOrigin","scrollWidth","right","scrollHeight","bottom","clientTop","clientLeft","clientHeight","getScrollHandleBounds","target","bounds","targetScrollTop","scrollTop","targetIsBody","pageXOffset","pageYOffset","innerHeight","innerWidth","getComputedStyle","hasBottomScroll","overflowX","scrollBottom","parseFloat","borderTopWidth","borderBottomWidth","borderLeftWidth","fitAdj","Math","pow","max","scrollPercentage","getVisibleBounds","min","removeUtilElements","node","boundingRect","getBoundingClientRect","rect","k","frameElement","defaultView","frameRect","err","setAttribute","getAttribute","cache","element","targetPos","getTargetBounds","abutted","side","targetPosSide","sides","options","length","addTargetClasses","BOUNDS_FORMAT","getBoundingRect","tether","to","scrollParents","nodeType","size","pos","win","i","toUpperCase","substr","_addOutOfBoundsClass","oob","addClasses","outOfBoundsClass","oobClass","_calculateOOBAndPinnedLeft","pin","pinned","_calculateOOBAndPinnedTop","_flipXTogether","tAttachment","eAttachment","targetWidth","_flipYTogether","targetHeight","_getAllClasses","constraints","allClasses","constraint","pinnedClass","targetAttachment","bodyElement","lastSize","targetSize","attachment","changeAttachX","changeAttachY","map","p","updateAttachClasses","trigger","shift","shiftTop","shiftLeft","Evented","on","event","handler","ctx","once","bindings","off","binding","index","splice","context","MIRROR_LR","center","MIRROR_TB","middle","OFFSET_MAP","addOffset","offsets","attachmentToOffset","autoToFixedAttachment","relativeToAttachment","offsetToPx","offset","parseTopLeft","getScrollParents","computedStyle","parents","parent","parentNode","overflowY","test","getOffsetParent","offsetParent","TetherBase","modules","Constraint","Abutment","Shift","isFullscreenElement","e","d","fe","fullscreenElement","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement","within","a","b","diff","transformKey","transforms","tethers","now","performance","lastCall","lastDuration","pendingTimeout","tick","setTimeout","clearTimeout","window","addEventListener","TetherClass","bind","history","setOptions","module","initialize","defaults","targetOffset","targetModifier","querySelector","Error","jquery","_addClasses","disable","enabled","enable","clearCache","_cache","getter","removeEventListener","destroy","_removeClasses","elementAttach","targetAttach","_addAttachClasses","flushChanges","elementPos","manualOffset","manualTargetOffset","ret","scrollbarSize","next","page","viewport","parentElement","optimizations","moveElement","offsetPosition","offsetParentStyle","offsetParentSize","offsetBorder","toLowerCase","scrollLeft","move","unshift","same","type","found","point","css","transcribe","_same","_pos","hasOptimizations","gpu","yPos","xPos","devicePixelRatio","round","allowPositionFixed","moved","offsetParentIsBody","currentNode","tagName","writeCSS","write","val","elVal","className","Tether","markers","dot"],"mappings":"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"}